# Make a webhook at the call disconnect (Flex Plugins)

## Setup function (Optional)

If you want to test your webhook, do the following steps.

### Preparation

```sh
% cd hangup-webhook
% cp .env.sample .env
```

Edit the `.env` file.  
Overwrite `ACCOUNT_SID` with your own Twilio Account Sid.

### Deploy

```sh
% npm run deploy
> hangup-webhook@1.0.0 deploy
> twilio serverless:deploy


Deploying functions & assets to the Twilio Runtime

Username        SKbaad0fc3c0aee030edf434f64bf36aa2
Password        tSUW****************************
Service SID     ZS835af79cceb4b1f40a2069ace2546ff9
Environment     dev
Root Directory  /***/plugin-hangup-webhook/hangup-webhook
Dependencies    twilio, @twilio/runtime-handler
Env Variables
Runtime         node14

âœ” Serverless project successfully deployed

Deployment Details
Domain: hangup-webhook-XXXX-dev.twil.io
Service:
   hangup-webhook (ZS835af79cceb4b1f40a2069ace2546ff9)
Environment:
   dev (ZEc3affd8d1c4d006d820845cb51796e18)
Build SID:
   ZB77a69286ed0b0062337edac96333e85a
Runtime:
   node14
View Live Logs:
   https://www.twilio.com/console/functions/editor/ZS835af79cceb4b1f40a2069ace2546ff9/environment/ZEc3affd8d1c4d006d820845cb51796e18
Functions:
   https://hangup-webhook-XXXX-dev.twil.io/webhook
Assets:
```

When the deployment is complete, record the "Domain:" shown in the results. Such as "hangup-webhook-XXXX-dev.twil.io".

## Setup Plugin

```sh
% cd ../
% cp .env.sample .env
```

Update the copied .env file with an editor.The contents to be updated are as follows.

Params|Values
:--|:--
FLEX_APP_WEBHOOK_URL|The url of the Webhook. If you have already set up Function in the previous step, specify the URL issued there.

Don't forget to prefix each parameter with "FLEX_APP_".

Once the .env file has been updated, build and deploy with the following command.

### Build & Deploy

```sh
% npm install
% npm run build && npm run deploy


> plugin-hangup-webhook@0.0.13 build
> twilio flex:plugins:build

...

ðŸš€ Plugin (private) plugin-hangup-webhook@0.0.14 was successfully deployed using Plugins API

Next Steps:
Run $ twilio flex:plugins:release --plugin plugin-hangup-webhook@0.0.14 --name "Autogenerated Release 1656481163914" --description "The description of this Flex Plugin Configuration." to enable this plugin on your Flex application
```

Finally, execute the release command as described in "Next Steps:".

```sh
% twilio flex:plugins:release --plugin plugin-hangup-webhook@0.0.14 --name "Autogenerated Release 1656481163914" --description "The description of this Flex Plugin Configuration."
Using profile XXXXXXXXXXX (AC***)

âœ” Creating configuration
âœ” Enabling configuration FJ***

ðŸš€ Configuration FJ*** was successfully enabled.

Next Steps:
Visit https://flex.twilio.com/admin/plugins to see your plugin(s) live on Flex.
```

## Restrictions

If you wish to use this plugin with Salesforce integration, you will need to upgrade Click-to-Dial. Please refer to the following link for upgrade instructions.

<https://www.twilio.com/docs/flex/admin-guide/integrations/salesforce/upgrade-guide>
